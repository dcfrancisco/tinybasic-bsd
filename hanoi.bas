10 REM TOWERS OF HANOI (CBM BASIC V2, ITERATIVE)
20 PRINT CHR$(147)
30 PRINT "TOWERS OF HANOI"
40 PRINT "NUMBER OF DISKS (1-13)";: INPUT N
50 IF N<1 THEN PRINT "1-13 PLEASE": GOTO 40
55 IF N>13 THEN PRINT "1-13 PLEASE": GOTO 40
60 REM COMPUTE M = 2^N - 1 (NO ^ OPERATOR HERE)
61 M=1
62 FOR I=1 TO N
63 M=M*2
64 NEXT I
65 M=M-1
70 DIM P(3,13),T(3)
80 FOR I=N TO 1 STEP -1
90 T(1)=T(1)+1: P(1,T(1))=I
100 NEXT I
110 T(2)=0: T(3)=0
120 D=3: A=2
130 IF N-2*INT(N/2)=0 THEN D=2: A=3
140 MOVES=0
150 REM (TI/TI$ NOT IMPLEMENTED IN THIS INTERPRETER)
160 FOR I=1 TO M
170 Q=I-3*INT(I/3)
180 IF Q=1 THEN P1=1: P2=D: GOSUB 500: GOTO 220
190 IF Q=2 THEN P1=1: P2=A: GOSUB 500: GOTO 220
200 P1=A: P2=D: GOSUB 500
220 NEXT I
230 PRINT
240 PRINT "DONE IN";MOVES;"MOVES"
260 END
500 REM MOVE LEGAL DISK BETWEEN PEGS P1 AND P2
510 IF T(P1)=0 THEN FROM=P2: TO=P1: GOTO 560
520 IF T(P2)=0 THEN FROM=P1: TO=P2: GOTO 560
530 D1=P(P1,T(P1)): D2=P(P2,T(P2))
540 IF D1<D2 THEN FROM=P1: TO=P2: GOTO 560
550 FROM=P2: TO=P1
560 DISK=P(FROM,T(FROM))
570 T(FROM)=T(FROM)-1
580 T(TO)=T(TO)+1
590 P(TO,T(TO))=DISK
600 MOVES=MOVES+1
610 PRINT MOVES;": MOVE DISK ";DISK;" FROM ";FROM;" TO ";TO
620 RETURN